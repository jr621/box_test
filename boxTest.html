<!DOCTYPE html>
<html>
<head>
	<title>Box Test</title>
	<style type="text/css">
    canvas {
      border: solid 1px #000;
    }
  </style>
</head>
<body>
	<canvas id="canvas" width="600" height="400"></canvas>
	<script type="text/javascript">

	var canvas = document.getElementById("canvas");
    var context = canvas.getContext("2d");
    var boxes = [];
    var colors = ["red", "blue", "black", "maroon", "yellow", "orange", "purple"];

    var gameSettings = {
        maxSize: 50,
        numberOfBoxes: 3,
        maxDuration: 100
    }

    function randomNum(n) {
        return Math.floor(Math.random() * n);
    }

    function createBox() {
    	return {
    		x: randomNum(canvas.width - gameSettings.maxSize),
	    	y: randomNum(canvas.height - gameSettings.maxSize),
	    	size: randomNum(gameSettings.maxSize) + 10,
	    	color: colors[randomNum(7)],
            duration: randomNum(gameSettings.maxDuration) + 10
    	}
    }

    function step() {
        for(i=0; i<boxes.length; i++) {
          boxes[i].duration --;
            if(boxes[i].duration < 0) {
            boxes[i] = createBox();
            }
        }
    }

    function createBoxes(n) {
        for(i=0; i<n; i++) {
            boxes.push(createBox());
        }
    }

    function drawBox() {
        for(i=0; i<boxes.length; i++) {
           context.fillStyle = boxes[i].color;
    	   context.fillRect(boxes[i].x,boxes[i].y,boxes[i].size,boxes[i].size);
        }
    }

    function runGame() {
        context.clearRect(0,0,canvas.width,canvas.height);
        step();
        drawBox();
        createBox();
        requestAnimationFrame(runGame);
    }
    runGame();
    createBoxes(gameSettings.numberOfBoxes);
    console.log(boxes);
	</script>
</body>
</html>